doctype html
html
    head
        title toDO.list - #{user}
        meta(name="viewport" content="width=device-width, initial-scale=1.0")
        script(src ="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js")
        script(src="./node_modules/bootstrap/dist/js/bootstrap.min.js")
        script(src="./node_modules/bootstrap-treeview/public/js/bootstrap-treeview.js")
        link(href="./node_modules/bootstrap-treeview/public/css/bootstrap-treeview.css" rel="stylesheet")
        link(href="./static/css/theme.min.css" rel="stylesheet")
        link(href="./static/css/home.css" rel="stylesheet")
        script.
            $(document).ready(updateTreeView());
            function updateTreeView(data) {
                var treeData=[];
                if(!data) {
                    $.get("/home/getTreeData", (data) => { 
                        console.log(treeData);
                        treeData=data;
                        //treeData.push({
                        //    text: newCat, href: '/home/viewList?cat=' + newCat, nodes: [{  text: 'New list', 
                        //    tags: ["<a href=\"/home/createList?cat=" + newCat + "\">Create List</a>"]}]
                        //});
                        //treeData.push ({
                        //    text: 'New category', href:"/home/createList", icon: "glyphicon glyphicon-plus",
                        //    tags:["<a data-toggle=\"modal\" data-target=\"#myModal\">New category</a>"]
                        // });
                        $("#tree").treeview({data:treeData, 
                                         enableLinks:true,
                                         showTags: true,
                                         expandIcon: "glyphicon glyphicon-tags",
                                         collapseIcon: "glyphicon glyphicon-tags",
                                         onNodeSelected: onNodeSelected,
                                         showBorder: false,
                                         selectedBackColor: "#a0a0a0" });
                    });
                }
                   
                                    
            }
            function onNodeSelected(event, node) {
                $.post("/home/viewList", {parent : $("#tree").treeview("getParent", node), name: node.text, id: node.id} , (data)=>{
                    $("#listView").html(data.toString());
                });
            }
            function createList() {
                $.get("/home/createList", (data) => updateTreeView(data));  
            }
            function deleteList(){
                alert( $("#tree").treeview("getSelected"));
            }
    body
        div(class="container-fluid" id="index")
            div(class="row")
                nav(class="navbar navbar-default")
                    div(class="container-fluid")
                        div(class="navbar-header")
                            a(id="brand-text" class="navbar-brand" href="/") toDO.list
                        ul(class="nav navbar-nav")
                            li
                                a(href="/home" id="navbar-item") Home
                            li
                                a(href="#" id="navbar-item") About
                        ul(class="nav navbar-nav navbar-right")               
                            li
                                a(href="/logout" id="navbar-item") Logout
                            li
                                a(id="navbar-item") 
                                    b #{user}
        div(id="tree" style="width:30%; float:left;")
        div(id="listView" style="width:70%; float:left")
        a(class="btn-lg btn-primary" href="home/createList" role="button") Create list
        //input(type="button" class="btn-lg btn-primary" value="create list" onclick="createList()")
        //div(class="modal fade" id="myModal" role="dialog")
            //div(class="modal-dialog modal-sm")
                //div(class="modal-content")
                    //div(class="modal-header")
                        //button(type="button" class="close" data-dismiss="modal") &times;
                        //h4(class="modal-title") New category
                    //div(class="modal-body")
                        //input(type="form-control" id="catName" placeholder="Category name" name="campo1")
                        //input(class="btn btn-primary" type="button" value="Ok" data-dismiss="modal" onclick="createCat()")